# Definindo os parâmetros
$VMName = "SRV-AD-02"
$MemoryStartupBytes = 2GB
$VHDPath = "D:\EDU-POPOVICI\VMS\$VMName\$VMName.vhdx"
$VHDSize = 127GB
$VMPath = "D:\EDU-POPOVICI\VMS\"

# Criando a máquina virtual
New-VM -Name $VMName -MemoryStartupBytes $MemoryStartupBytes -Path $VMPath -Generation 2

# Configurando a memória sem a opção de memória dinâmica
Set-VM -Name $VMName -DynamicMemoryEnabled $false

# Criando o disco virtual dinâmico
New-VHD -Path $VHDPath -SizeBytes $VHDSize -Dynamic

# Adicionando o disco virtual à VM
Add-VMHardDiskDrive -VMName $VMName -Path $VHDPath

# Adicionando a interface de rede desconectada
Add-VMNetworkAdapter -VMName $VMName -SwitchName "None"

# Configuração final
Write-Host "Máquina virtual $VMName criada com sucesso com 2GB de RAM, disco de 127GB dinâmico, e interface de rede desconectada."
